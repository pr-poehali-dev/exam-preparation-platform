import React, { useState, useEffect } from 'react';
import { Card, CardContent, CardHeader, CardTitle } from '@/components/ui/card';
import { Button } from '@/components/ui/button';
import { Progress } from '@/components/ui/progress';
import { Badge } from '@/components/ui/badge';
import Icon from '@/components/ui/icon';

// Категории тестов
const testCategories = {
  "basics": {
    name: "Основы вычислительных систем",
    description: "Общие требования и принципы построения ЭВМ",
    icon: "Computer",
    color: "blue"
  },
  "networks": {
    name: "Компьютерные сети",
    description: "Архитектура сетей и передача данных",
    icon: "Network",
    color: "green"
  },
  "os": {
    name: "Операционные системы",
    description: "Структура и функции ОС",
    icon: "Cog",
    color: "purple"
  },
  "programming": {
    name: "Программное обеспечение",
    description: "ООП, базы данных и разработка ПО",
    icon: "Code",
    color: "orange"
  },
  "modern": {
    name: "Современные технологии",
    description: "Облачные технологии и ИИ",
    icon: "Cloud",
    color: "cyan"
  },
  "security": {
    name: "Информационная безопасность",
    description: "Защита данных и систем",
    icon: "Shield",
    color: "red"
  },
  "analysis": {
    name: "Системный анализ",
    description: "Методы исследования систем",
    icon: "BarChart3",
    color: "yellow"
  }
};

// Полная база данных вопросов
const examQuestions = {
  "basics": [
    {
      id: 1,
      question: "Какие общие требования предъявляются к современным вычислительным системам?",
      options: [
        "Отсутствие необходимости в программных средствах общения с ЭВМ.",
        "Повышение быстродействия и снижение стоимости арифметических операций и единицы памяти, разработка программных средств общения с ЭВМ, возможность решения сложных прикладных и математических задач.",
        "Только увеличение объёма оперативной памяти.",
        "Ограничение возможностей решения сложных прикладных задач."
      ],
      correct: 1
    },
    {
      id: 2,
      question: "Что включает в себя общая теория построения ЭВМ?",
      options: [
        "Только принципы работы оперативной памяти.",
        "Архитектуру компьютерных сетей, принципы передачи и обмена информацией между ЭВМ и периферийными устройствами, основные операции над сигналами в периферийных устройствах, модели архитектур информационных систем, структуру ЭВМ (включая операционные системы, управление процессами, памятью, файлами и сигналами), а также развитие и совершенствование структуры ЭВМ.",
        "Только архитектуру компьютерных сетей.",
        "Только модели архитектурных решений для глобальных сетей."
      ],
      correct: 1
    },
    {
      id: 3,
      question: "Как развитие и совершенствование структуры ЭВМ влияет на их быстродействие и объём памяти?",
      options: [
        "Не влияет никак.",
        "Способствует повышению быстродействия и расширению объёма памяти.",
        "Ухудшает быстродействие.",
        "Только увеличивает объём памяти."
      ],
      correct: 1
    },
    {
      id: 4,
      question: "Перечислите общие принципы передачи и обмена информацией между ЭВМ и периферийными устройствами.",
      options: [
        "Передача информации осуществляется только через проводные соединения.",
        "Обмен информацией опирается на цифровые технологии, двоичное представление данных и сетевые технологии передачи информации.",
        "Информация передаётся исключительно через специальные аналоговые сигналы.",
        "Обмен информацией происходит только через облачные сервисы."
      ],
      correct: 1
    },
    {
      id: 5,
      question: "Какие операции выполняются над сигналами в периферийных устройствах?",
      options: [
        "Никаких операций не выполняется.",
        "Операционная система обрабатывает сигналы, поступающие от аппаратного обеспечения и программного обеспечения, и координирует взаимодействие между ними, что позволяет обеспечить корректную работу системы и реагировать на различные события.",
        "Сигналы только передаются без какой-либо обработки.",
        "Сигналы преобразуются в текстовые данные."
      ],
      correct: 1
    }
  ],
  "networks": [
    {
      id: 1,
      question: "Что такое архитектура компьютерных сетей?",
      options: [
        "Совокупность только физических компонентов сети.",
        "Сложная структура, которая включает в себя различные сервисы и протоколы для обеспечения работы Интернета и других глобальных сервисов, а также элементы сети, средства объединения устройств, системы адресации и механизмы управления.",
        "Набор правил для работы с локальными сетями.",
        "Система, не включающая в себя механизмы управления и сервисы."
      ],
      correct: 1
    },
    {
      id: 2,
      question: "Перечислите ключевые аспекты архитектуры компьютерных сетей.",
      options: [
        "Только элементы сети.",
        "Элементы сети, средства объединения устройств, системы адресации, механизмы управления, структура глобальных сетей.",
        "Только механизмы управления.",
        "Только средства объединения устройств."
      ],
      correct: 1
    },
    {
      id: 3,
      question: "Что такое базовая топология сети и какова её роль в архитектуре компьютерных сетей?",
      options: [
        "Топология сети — это способ соединения устройств в сети, который не влияет на её характеристики.",
        "Топология сети — это один из ключевых аспектов архитектуры компьютерных сетей, который определяет способ соединения устройств и влияет на надёжность, скорость передачи данных и удобство управления сетью.",
        "Топология сети определяет только физическое расположение устройств.",
        "Топология сети не имеет значения для работы сети."
      ],
      correct: 1
    },
    {
      id: 4,
      question: "Что такое локальная сеть и как она организуется?",
      options: [
        "Локальная сеть — это сеть, которая объединяет компьютеры в разных странах; организуется без использования систем адресации.",
        "Локальная сеть — это сеть, которая состоит из ряда элементов, обеспечивающих взаимодействие между компьютерами и другими устройствами; использует систему адресации для идентификации устройств и передачи данных, позволяет совместно использовать ресурсы (файлы, принтеры, интернет-соединение).",
        "Локальная сеть нужна только для подключения принтеров.",
        "Локальная сеть организуется без каких-либо технологий и средств объединения устройств."
      ],
      correct: 1
    },
    {
      id: 5,
      question: "Какие базовые топологии сетей существуют?",
      options: [
        "Топология сети не имеет значения для её работы.",
        "Существуют различные базовые топологии, которые определяют способ соединения устройств в сети и влияют на её характеристики (надёжность, скорость передачи данных, удобство управления).",
        "Существует только одна универсальная топология для всех сетей.",
        "Топология определяется исключительно количеством устройств в сети."
      ],
      correct: 1
    },
    {
      id: 6,
      question: "Как устроена передача информации в компьютерных сетях?",
      options: [
        "Передача информации происходит без использования каких-либо протоколов и систем адресации.",
        "Используются компьютерные сети (локальные и глобальные), различные протоколы и технологии передачи данных, системы адресации для идентификации устройств и обеспечения передачи данных.",
        "Информация передаётся только через физические носители.",
        "Передача данных возможна только в пределах одного здания."
      ],
      correct: 1
    },
    {
      id: 7,
      question: "Как устроена система адресации в локальных и глобальных сетях?",
      options: [
        "В локальных и глобальных сетях используется одна и та же система адресации.",
        "В локальных сетях используется специальная система адресации для идентификации устройств, а в глобальных сетях существует своя система адресации, которая позволяет устройствам обмениваться данными на международном уровне.",
        "Системы адресации не используются в сетях.",
        "Адресация нужна только для глобальных сетей."
      ],
      correct: 1
    },
    {
      id: 8,
      question: "Что обеспечивают сетевые операционные системы в архитектуре компьютерных сетей?",
      options: [
        "Только управление файлами.",
        "Взаимодействие между компьютерами, управление ресурсами и обмен данными между устройствами в сети.",
        "Только защиту от вирусов.",
        "Ничего не обеспечивают."
      ],
      correct: 1
    },
    {
      id: 9,
      question: "Какие механизмы используются для управления сетью и обеспечения её безопасности?",
      options: [
        "Никаких механизмов не используется.",
        "Различные механизмы и инструменты для контроля и оптимизации работы сети, обеспечения её безопасности и надёжности.",
        "Только маршрутизаторы.",
        "Только файрволы."
      ],
      correct: 1
    },
    {
      id: 10,
      question: "Что такое глобальные сети и какие сервисы и протоколы они включают?",
      options: [
        "Глобальные сети — это сети, которые объединяют только компьютеры в одном здании.",
        "Глобальные сети имеют сложную архитектуру, которая включает различные сервисы и протоколы для обеспечения работы Интернета и других глобальных сервисов.",
        "Глобальные сети не используют протоколы.",
        "Глобальные сети включают только один сервис."
      ],
      correct: 1
    }
  ],
  "os": [
    {
      id: 1,
      question: "Перечислите основные компоненты сетевой операционной системы.",
      options: [
        "Только средства управления файлами.",
        "Средства обеспечения взаимодействия между компьютерами, управления ресурсами и обмена данными, средства управления процессами, памятью, файлами и обработки сигналов.",
        "Исключительно инструменты для работы с периферийными устройствами.",
        "Компоненты, не связанные с управлением ресурсами и обменом данными."
      ],
      correct: 1
    },
    {
      id: 2,
      question: "Какие аспекты включает в себя структура ЭВМ?",
      options: [
        "Только оперативная память и процессор.",
        "Операционные системы, управление процессами, памятью, файлами и сигналами.",
        "Только системы ввода-вывода.",
        "Только периферийные устройства."
      ],
      correct: 1
    },
    {
      id: 3,
      question: "В чём заключается роль сетевых операционных систем в управлении ресурсами и обменом данными?",
      options: [
        "Сетевые ОС не участвуют в управлении ресурсами.",
        "Сетевые ОС обеспечивают взаимодействие между компьютерами, позволяют управлять ресурсами и обмениваться данными между устройствами в сети, координируют работу сетевых сервисов и управляют доступом к сетевым ресурсам.",
        "Сетевые ОС нужны только для защиты от вирусов.",
        "Сетевые ОС отвечают только за подключение к Интернету."
      ],
      correct: 1
    },
    {
      id: 4,
      question: "Какие элементы определяют архитектуру глобальных сетей?",
      options: [
        "Только маршрутизаторы.",
        "Различные сервисы и протоколы для обеспечения работы Интернета и других глобальных сервисов, элементы сети, средства объединения устройств, системы адресации, механизмы управления.",
        "Только системы адресации.",
        "Только физические кабели."
      ],
      correct: 1
    },
    {
      id: 5,
      question: "Как топология сети влияет на её характеристики (надёжность, скорость передачи данных)?",
      options: [
        "Топология сети не влияет на её характеристики.",
        "Топология определяет способ соединения устройств в сети и влияет на надёжность, скорость передачи данных и удобство управления сетью.",
        "Топология влияет только на физическое расположение устройств.",
        "Топология важна только для глобальных сетей."
      ],
      correct: 1
    },
    {
      id: 6,
      question: "Какие операционные системы используются в вычислительных системах строительства?",
      options: [
        "В строительстве не используются операционные системы.",
        "Могут использоваться как универсальные операционные системы, так и операционные системы специального назначения, в зависимости от задач и конфигурации вычислительных систем.",
        "Только операционные системы специального назначения.",
        "Только универсальные операционные системы."
      ],
      correct: 1
    },
    {
      id: 7,
      question: "Какие задачи решают средства управления файлами и обработкой сигналов в операционных системах?",
      options: [
        "Средства управления файлами и обработкой сигналов не выполняют никаких задач.",
        "Средства управления файлами позволяют создавать, изменять, удалять и искать файлы, контролировать доступ к ним; средства обработки сигналов координируют взаимодействие между аппаратным и программным обеспечением, обеспечивают корректную работу системы и реакцию на различные события.",
        "Средства управления файлами нужны только для хранения данных, а средства обработки сигналов — только для звука.",
        "Средства управления файлами отвечают только за копирование данных, а средства обработки сигналов — за передачу данных по сети."
      ],
      correct: 1
    },
    {
      id: 8,
      question: "В чём заключаются особенности аппаратных платформ и как они влияют на работу операционной системы?",
      options: [
        "Аппаратные платформы не влияют на работу ОС.",
        "Аппаратные платформы определяют технические возможности и ограничения, с которыми должна работать ОС; ОС должна учитывать особенности аппаратного обеспечения при управлении ресурсами и обеспечении взаимодействия между компонентами системы.",
        "Влияние аппаратных платформ на ОС заключается только в объёме оперативной памяти.",
        "Аппаратные платформы влияют только на скорость работы ОС."
      ],
      correct: 1
    },
    {
      id: 9,
      question: "Какие методы построения операционных систем существуют и чем они отличаются?",
      options: [
        "Методы построения ОС не различаются.",
        "Методы построения ОС могут различаться в зависимости от целей и области применения системы (например, универсальные ОС или ОС специального назначения); при разработке ОС учитываются такие аспекты, как управление процессами, памятью, файлами, обработка сигналов и взаимодействие с аппаратурой.",
        "Методы построения ОС отличаются только по цвету интерфейса.",
        "Методы построения ОС зависят только от объёма оперативной памяти компьютера."
      ],
      correct: 1
    }
  ],
  "programming": [
    {
      id: 1,
      question: "Каковы основные функции операционных систем?",
      options: [
        "Только запуск программ.",
        "Управление процессами, управление памятью, управление файлами, обработка сигналов, обеспечение интерфейса для взаимодействия пользователя с компьютером, координация работы аппаратных и программных компонентов компьютера.",
        "Только обеспечение интерфейса для пользователя.",
        "Только управление памятью."
      ],
      correct: 1
    },
    {
      id: 2,
      question: "Чем отличаются универсальные операционные системы от операционных систем специального назначения?",
      options: [
        "Универсальные ОС предназначены только для серверов, а ОС специального назначения — для персональных компьютеров.",
        "Универсальные ОС предназначены для широкого круга пользователей и применяются в различных сферах, а ОС специального назначения разрабатываются для решения конкретных задач или работы на определённых типах оборудования.",
        "Универсальные ОС работают только на определённых аппаратных платформах, а ОС специального назначения — на любых.",
        "Отличие заключается только в интерфейсе."
      ],
      correct: 1
    },
    {
      id: 3,
      question: "Какие аспекты учитываются при разработке операционных систем?",
      options: [
        "Только управление процессами.",
        "Управление процессами, памятью, файлами, обработка сигналов, взаимодействие с аппаратурой, особенности аппаратных платформ, методы построения и архитектуры ОС, возможности работы в сети.",
        "Только взаимодействие с пользователем.",
        "Только защита от вирусов."
      ],
      correct: 1
    },
    {
      id: 4,
      question: "Что такое объектно-ориентированный подход в программировании и каковы его основные понятия?",
      options: [
        "Это подход, который рассматривает программу как набор команд. Основные понятия: циклы и условия.",
        "Это подход, который рассматривает программу в качестве набора объектов, взаимодействующих между собой. Основные понятия: абстракция, инкапсуляция, наследование, полиморфизм.",
        "Это подход, который использует только математические алгоритмы. Основные понятия: функции и переменные.",
        "Это подход, который основан на использовании только готовых библиотек. Основные понятия: модули и пакеты."
      ],
      correct: 1
    },
    {
      id: 5,
      question: "Что включает в себя структура программы в соответствии с методологией объектно-ориентированного программирования?",
      options: [
        "Только набор функций.",
        "Четыре базовых элемента, которые связаны с основными понятиями ООП: абстракцией, инкапсуляцией, наследованием и полиморфизмом",
        "Только циклы и условия.",
        "Только переменные и константы."
      ],
      correct: 1
    },
    {
      id: 6,
      question: "Что такое реляционная модель данных и какие языки запросов к ней используются?",
      options: [
        "Реляционная модель — это способ организации данных в виде графов, используется язык запросов XML.",
        "Реляционная модель — это способ организации и хранения данных, основанный на математических принципах реляционной алгебры; данные представляются в виде таблиц. Для работы с реляционными базами данных используется язык SQL.",
        "Реляционная модель использует иерархическую структуру, для запросов применяется язык C++.",
        "Реляционная модель основана на сетевых принципах, для запросов используется язык Python."
      ],
      correct: 1
    },
    {
      id: 7,
      question: "Какие технологии и инструменты программирования используются для разработки программного обеспечения?",
      options: [
        "Только текстовые редакторы.",
        "Среды разработки (например, Microsoft Visual Studio), компиляторы и интерпретаторы, библиотеки и пакеты стандартных программ, языки программирования высокого уровня (например, C++, Visual Basic, Visual C#).",
        "Только калькуляторы.",
        "Только онлайн-сервисы для создания презентаций."
      ],
      correct: 1
    },
    {
      id: 8,
      question: "Как используются базы данных и системы управления базами данных в информационных системах?",
      options: [
        "Базы данных нужны только для хранения фотографий. СУБД используются только в мобильных приложениях.",
        "Базы данных и СУБД используются для управления информацией, автоматизации обработки данных, ускорения поиска информации, повышения эффективности работы с данными.",
        "Базы данных используются только в библиотеках. СУБД нужны только для видеоигр.",
        "Базы данных применяются только в научных исследованиях. СУБД используются только в государственных учреждениях."
      ],
      correct: 1
    }
  ],
  "modern": [
    {
      id: 1,
      question: "Что такое облачные вычисления и какие преимущества они предоставляют?",
      options: [
        "Облачные вычисления — это технология печати документов. Преимущества: экономия бумаги.",
        "Облачные вычисления — это технология, которая позволяет использовать вычислительные ресурсы и хранить данные на удалённых серверах, доступ к которым осуществляется через интернет. Преимущества: работа с большими объёмами данных без значительных локальных вычислительных мощностей, экономия на приобретении и обслуживании серверного оборудования, возможность доступа к данным из любой точки мира, гибкое масштабирование ресурсов.",
        "Облачные вычисления нужны только для игр. Преимущества: быстрый запуск игр.",
        "Облачные вычисления используются только в банках. Преимущества: повышенная безопасность данных."
      ],
      correct: 1
    },
    {
      id: 2,
      question: "Как интеллектуальные алгоритмы помогают в автоматизации проектных работ?",
      options: [
        "Они не оказывают никакого влияния на проектные работы.",
        "Они помогают автоматизировать часть проектных работ, ускорить процесс принятия решений и повысить его качество за счёт более глубокого анализа данных.",
        "Они нужны только для создания 3D-моделей.",
        "Они используются только для расчёта стоимости проекта."
      ],
      correct: 1
    },
    {
      id: 3,
      question: "В чём заключается роль систем искусственного интеллекта в поддержке принятия управленческих решений?",
      options: [
        "Системы ИИ не участвуют в принятии управленческих решений.",
        "Системы ИИ могут анализировать большие объёмы данных, выявлять закономерности и предоставлять рекомендации для принятия решений, что помогает оптимизировать процессы, прогнозировать результаты и снижать риск ошибок.",
        "Системы ИИ нужны только для развлечения.",
        "Системы ИИ используются только для контроля доступа в здания."
      ],
      correct: 1
    },
    {
      id: 4,
      question: "Какие типы данных могут обрабатывать интеллектуальные системы в строительстве?",
      options: [
        "Только числовые данные.",
        "Числовые, текстовые и графические данные.",
        "Только текстовые данные.",
        "Только данные о погодных условиях."
      ],
      correct: 1
    },
    {
      id: 5,
      question: "Как автоматизированные системы управления помогают оптимизировать строительные процессы?",
      options: [
        "Они никак не влияют на строительные процессы.",
        "Они помогают управлять строительными процессами, ресурсами, документооборотом и другими аспектами проекта, автоматизировать рутинные задачи, повысить эффективность работы, оптимизировать использование материалов, техники и рабочей силы.",
        "Они нужны только для учёта рабочего времени сотрудников.",
        "Они используются только для проектирования зданий."
      ],
      correct: 1
    },
    {
      id: 6,
      question: "Что такое корпоративная информационная система и как она используется в строительной отрасли?",
      options: [
        "Корпоративная информационная система — это система для хранения личных данных сотрудников. В строительной отрасли она не используется.",
        "Корпоративная информационная система — это система, которая обеспечивает сбор, хранение, обработку и распространение информации в рамках организации. В строительной отрасли она помогает интегрировать бизнес-процессы, улучшить координацию между подразделениями, повысить эффективность работы компании, обеспечить доступ всех участников проекта к актуальным данным.",
        "Корпоративная информационная система нужна только для бухгалтерского учёта.",
        "Корпоративная информационная система используется только в государственных учреждениях."
      ],
      correct: 1
    },
    {
      id: 7,
      question: "Как системы автоматизации проектирования упрощают создание проектной документации?",
      options: [
        "Они не влияют на процесс создания проектной документации.",
        "Они позволяют упрощать и ускорять процесс создания проектной документации, анализировать проектные решения и визуализировать объекты, создавать информационные модели объектов капитального строительства, которые включают данные о конструкции, материалах, инженерных системах и других параметрах.",
        "Они нужны только для печати чертежей.",
        "Они используются только для создания архитектурных визуализаций."
      ],
      correct: 1
    },
    {
      id: 8,
      question: "В чём преимущество использования BIM-технологий в строительстве?",
      options: [
        "BIM-технологии не имеют преимуществ.",
        "BIM-технологии позволяют создавать и использовать единую цифровую модель объекта строительства, которая включает данные о конструкции, материалах, инженерных системах, сроках и стоимости строительства и другие параметры. Это облегчает совместную работу участников проекта, анализ характеристик объекта и управление информацией на всех этапах жизненного цикла.",
        "BIM-технологии нужны только для создания виртуальных туров по зданиям.",
        "BIM-технологии используются только для визуализации."
      ],
      correct: 1
    }
  ],
  "security": [
    {
      id: 1,
      question: "Как базы знаний применяются в строительных информационных системах?",
      options: [
        "Базы знаний не используются в строительных информационных системах.",
        "Базы знаний используются для хранения знаний экспертов в определённых предметных областях, например, в строительстве. Они содержат логически полный и ограниченный набор сведений, данных или программ, которые могут использоваться для решения специализированных задач, таких как проектирование, управление ресурсами, анализ проектных решений.",
        "Базы знаний нужны только для хранения исторических данных о построенных объектах.",
        "Базы знаний применяются только для обучения новых сотрудников."
      ],
      correct: 1
    },
    {
      id: 2,
      question: "Какие меры используются для обеспечения информационной безопасности в вычислительных системах и сетях?",
      options: [
        "Никаких мер не используется.",
        "Используются технические меры (шифрование, аутентификация, контроль доступа), архивирование и резервирование информации, создание защитных атрибутов и защищённых сетевых соединений, антивирусная защита и защита от вредоносных программ, классификация и оценка уровня угроз и рисков, разработка и внедрение политик и процедур безопасности.",
        "Используется только установка паролей на компьютеры.",
        "Применяется только физическое ограничение доступа в серверные помещения."
      ],
      correct: 1
    }
  ],
  "analysis": [
    {
      id: 1,
      question: "Что такое системный анализ и каковы его этапы?",
      options: [
        "Системный анализ — это метод быстрого решения простых задач. Этапы: постановка задачи и её решение.",
        "Системный анализ — это процесс исследования и оценки строительных и других систем с целью выявления их свойств, структуры и поведения. Этапы: определение цели и задач анализа, сбор и анализ информации, моделирование системы, анализ структуры и поведения системы, выявление проблем и возможностей.",
        "Системный анализ нужен только для анализа финансовых показателей. Этапы: расчёт доходов и расходов.",
        "Системный анализ используется только в медицине. Этапы: диагностика и лечение."
      ],
      correct: 1
    },
    {
      id: 2,
      question: "В чём заключается важность системного подхода к анализу строительных систем?",
      options: [
        "Системный подход не имеет значения для анализа строительных систем.",
        "Системный подход позволяет учитывать многогранность и сложность объекта строительства, оптимизировать процессы проектирования и строительства, а также обеспечить эффективное использование ресурсов и достижение поставленных целей.",
        "Системный подход нужен только для расчёта количества строительных материалов.",
        "Системный подход используется только для определения цвета фасада здания."
      ],
      correct: 1
    },
    {
      id: 3,
      question: "Как системный анализ помогает в управлении строительными процессами?",
      options: [
        "Он не оказывает никакого влияния на управление строительными процессами.",
        "Системный анализ помогает управлять сложностью строительных процессов, обеспечивать эффективное выполнение проекта, оптимизировать использование ресурсов, выявлять проблемы и возможности для улучшения, анализировать взаимосвязи между элементами системы и их влияние на общую эффективность и надёжность.",
        "Системный анализ нужен только для составления списка необходимых инструментов.",
        "Он используется только для планирования обедов рабочих."
      ],
      correct: 1
    },
    {
      id: 4,
      question: "Какие виды моделей используются в системном анализе?",
      options: [
        "Используется только один вид моделей.",
        "В системном анализе используются математические, информационные, функциональные и другие модели. В контексте строительства применяются информационные модели объектов капитального строительства, которые помогают визуализировать и анализировать объекты, оптимизировать процессы проектирования и строительства.",
        "Применяются только физические модели зданий.",
        "Используются только модели для расчёта стоимости строительства."
      ],
      correct: 1
    },
    {
      id: 5,
      question: "Перечислите модели архитектур информационных систем.",
      options: [
        "Модели архитектур не существуют.",
        "Модели архитектур могут определять структуру и взаимодействие компонентов, например, способы организации данных (реляционные базы данных, иерархические и сетевые системы), механизмы обработки информации и выполнения запросов, методы обеспечения взаимодействия между пользователями и системой, а также между различными компонентами системы.",
        "Существует только одна универсальная модель архитектуры.",
        "Модели архитектур используются только в строительстве."
      ],
      correct: 1
    },
    {
      id: 6,
      question: "Какие сервисы и службы управления существуют в информационных системах?",
      options: [
        "В информационных системах нет сервисов и служб управления.",
        "Сервисы и службы управления обеспечивают управление ресурсами и процессами, безопасность и надёжность работы системы, взаимодействие между различными компонентами и пользователями.",
        "Существуют только сервисы для резервного копирования данных.",
        "Есть только службы для управления пользовательскими паролями."
      ],
      correct: 1
    }
  ]
};

const achievements = [
  { name: "Первые шаги", description: "Прошли первый тест", icon: "Medal", unlocked: false },
  { name: "Знаток", description: "Набрали 80%+ баллов", icon: "Award", unlocked: false },
  { name: "Отличник", description: "5 тестов подряд на отлично", icon: "Trophy", unlocked: false },
  { name: "Исследователь", description: "Изучили все темы", icon: "BookOpen", unlocked: false }
];

const Index = () => {
  const [selectedCategory, setSelectedCategory] = useState<string | null>(null);
  const [currentQuestion, setCurrentQuestion] = useState(0);
  const [selectedAnswer, setSelectedAnswer] = useState<number | null>(null);
  const [showResult, setShowResult] = useState(false);
  const [score, setScore] = useState(0);
  const [testStarted, setTestStarted] = useState(false);
  const [answeredQuestions, setAnsweredQuestions] = useState(0);
  const [userAchievements, setUserAchievements] = useState(achievements);

  const currentQuestions = selectedCategory ? examQuestions[selectedCategory] : [];

  const handleAnswerSelect = (answerIndex: number) => {
    if (showResult) return;
    setSelectedAnswer(answerIndex);
  };

  const handleNextQuestion = () => {
    if (selectedAnswer === null) return;

    const isCorrect = selectedAnswer === currentQuestions[currentQuestion].correct;
    if (isCorrect) {
      setScore(score + 1);
    }

    setAnsweredQuestions(answeredQuestions + 1);
    setShowResult(true);

    setTimeout(() => {
      if (currentQuestion < currentQuestions.length - 1) {
        setCurrentQuestion(currentQuestion + 1);
        setSelectedAnswer(null);
        setShowResult(false);
      } else {
        // Тест завершен
        const finalScore = isCorrect ? score + 1 : score;
        const percentage = (finalScore / currentQuestions.length) * 100;
        
        // Разблокируем достижения
        const newAchievements = [...userAchievements];
        if (!newAchievements[0].unlocked) {
          newAchievements[0].unlocked = true;
        }
        if (percentage >= 80 && !newAchievements[1].unlocked) {
          newAchievements[1].unlocked = true;
        }
        setUserAchievements(newAchievements);
      }
    }, 2000);
  };

  const startTest = (category: string) => {
    setSelectedCategory(category);
    setTestStarted(true);
    setCurrentQuestion(0);
    setSelectedAnswer(null);
    setShowResult(false);
    setScore(0);
    setAnsweredQuestions(0);
  };

  const resetTest = () => {
    setTestStarted(false);
    setSelectedCategory(null);
    setCurrentQuestion(0);
    setSelectedAnswer(null);
    setShowResult(false);
    setScore(0);
    setAnsweredQuestions(0);
  };

  const progress = currentQuestions.length > 0 ? (answeredQuestions / currentQuestions.length) * 100 : 0;
  const isTestCompleted = currentQuestion === currentQuestions.length - 1 && showResult;

  // Экран выбора категории
  if (!testStarted) {
    return (
      <div className="min-h-screen bg-slate-50 p-6">
        {/* Header */}
        <header className="max-w-6xl mx-auto mb-8">
          <div className="flex justify-between items-center">
            <div>
              <h1 className="text-3xl font-bold text-slate-900 mb-2">
                Подготовка к экзамену
              </h1>
              <p className="text-slate-600">
                Система тестирования по вычислительным системам
              </p>
            </div>
            <div className="flex items-center gap-4">
              <Badge variant="secondary" className="px-3 py-1">
                <Icon name="User" size={16} className="mr-2" />
                Студент
              </Badge>
            </div>
          </div>
        </header>

        <div className="max-w-6xl mx-auto grid grid-cols-1 lg:grid-cols-3 gap-6">
          {/* Категории тестов */}
          <div className="lg:col-span-2">
            <div className="mb-6">
              <h2 className="text-xl font-semibold text-slate-900 mb-4">Выберите тему для тестирования:</h2>
              <div className="grid grid-cols-1 md:grid-cols-2 gap-4">
                {Object.entries(testCategories).map(([key, category]) => (
                  <Card key={key} className="exam-card hover:border-blue-300 cursor-pointer" onClick={() => startTest(key)}>
                    <CardContent className="p-4">
                      <div className="flex items-start gap-3">
                        <div className={`w-10 h-10 rounded-lg bg-${category.color}-100 flex items-center justify-center`}>
                          <Icon name={category.icon as any} size={20} className={`text-${category.color}-600`} />
                        </div>
                        <div className="flex-1">
                          <h3 className="font-medium text-slate-900 mb-1">{category.name}</h3>
                          <p className="text-sm text-slate-600 mb-2">{category.description}</p>
                          <div className="flex items-center gap-2 text-xs text-slate-500">
                            <Icon name="HelpCircle" size={12} />
                            <span>{examQuestions[key].length} вопросов</span>
                          </div>
                        </div>
                        <Icon name="ChevronRight" size={16} className="text-slate-400" />
                      </div>
                    </CardContent>
                  </Card>
                ))}
              </div>
            </div>

            {/* Смешанный тест */}
            <Card className="exam-card border-2 border-blue-200">
              <CardHeader>
                <CardTitle className="flex items-center gap-3">
                  <Icon name="Shuffle" size={24} className="text-blue-500" />
                  Комплексный тест
                </CardTitle>
              </CardHeader>
              <CardContent className="space-y-4">
                <p className="text-slate-600">
                  Тест включает вопросы из всех тем. Отличный способ проверить общие знания перед экзаменом.
                </p>
                <div className="flex items-center gap-4 text-sm text-slate-500">
                  <div className="flex items-center gap-1">
                    <Icon name="Clock" size={14} />
                    <span>30-40 минут</span>
                  </div>
                  <div className="flex items-center gap-1">
                    <Icon name="HelpCircle" size={14} />
                    <span>Все темы</span>
                  </div>
                </div>
                <Button 
                  onClick={() => startTest('basics')} // Начинаем с первой категории
                  className="w-full bg-blue-600 hover:bg-blue-700 text-white"
                >
                  <Icon name="Play" size={16} className="mr-2" />
                  Начать комплексный тест
                </Button>
              </CardContent>
            </Card>
          </div>

          {/* Боковая панель */}
          <div className="space-y-6">
            {/* Статистика */}
            <Card className="exam-card">
              <CardHeader>
                <CardTitle className="text-lg flex items-center gap-2">
                  <Icon name="BarChart3" size={20} className="text-green-500" />
                  Статистика
                </CardTitle>
              </CardHeader>
              <CardContent>
                <div className="space-y-4">
                  <div className="flex justify-between items-center">
                    <span className="text-sm text-slate-600">Пройдено тестов</span>
                    <Badge variant="outline">0</Badge>
                  </div>
                  <div className="flex justify-between items-center">
                    <span className="text-sm text-slate-600">Средний балл</span>
                    <Badge variant="outline">-</Badge>
                  </div>
                  <div className="flex justify-between items-center">
                    <span className="text-sm text-slate-600">Лучший результат</span>
                    <Badge variant="outline">-</Badge>
                  </div>
                </div>
              </CardContent>
            </Card>

            {/* Достижения */}
            <Card className="exam-card">
              <CardHeader>
                <CardTitle className="text-lg flex items-center gap-2">
                  <Icon name="Award" size={20} className="text-yellow-500" />
                  Достижения
                </CardTitle>
              </CardHeader>
              <CardContent>
                <div className="space-y-3">
                  {userAchievements.map((achievement, index) => (
                    <div 
                      key={index} 
                      className={`flex items-center gap-3 p-3 rounded-lg ${
                        achievement.unlocked ? 'bg-yellow-50 border border-yellow-200' : 'bg-slate-50'
                      }`}
                    >
                      <Icon 
                        name={achievement.icon as any} 
                        size={16} 
                        className={achievement.unlocked ? 'text-yellow-600' : 'text-slate-400'} 
                      />
                      <div className="flex-1">
                        <p className={`text-sm font-medium ${
                          achievement.unlocked ? 'text-yellow-900' : 'text-slate-500'
                        }`}>
                          {achievement.name}
                        </p>
                        <p className={`text-xs ${
                          achievement.unlocked ? 'text-yellow-700' : 'text-slate-400'
                        }`}>
                          {achievement.description}
                        </p>
                      </div>
                    </div>
                  ))}
                </div>
              </CardContent>
            </Card>
          </div>
        </div>
      </div>
    );
  }

  // Экран завершения теста
  if (isTestCompleted) {
    const percentage = (score / currentQuestions.length) * 100;
    return (
      <div className="min-h-screen bg-slate-50 p-6 flex items-center justify-center">
        <Card className="exam-card max-w-lg w-full">
          <CardHeader className="text-center">
            <div className="mx-auto w-16 h-16 bg-blue-100 rounded-full flex items-center justify-center mb-4">
              <Icon name="CheckCircle" size={32} className="text-blue-600" />
            </div>
            <CardTitle className="text-2xl">Тест завершен!</CardTitle>
            <p className="text-slate-600">
              {testCategories[selectedCategory!]?.name}
            </p>
          </CardHeader>
          <CardContent className="text-center space-y-6">
            <div>
              <div className="text-4xl font-bold text-blue-600 mb-2">
                {score} / {currentQuestions.length}
              </div>
              <div className="text-lg text-slate-600">
                {percentage.toFixed(0)}% правильных ответов
              </div>
            </div>

            <div className={`p-4 rounded-lg ${
              percentage >= 80 ? 'bg-green-50 text-green-800' :
              percentage >= 60 ? 'bg-yellow-50 text-yellow-800' :
              'bg-red-50 text-red-800'
            }`}>
              {percentage >= 80 ? '🎉 Отличный результат!' :
               percentage >= 60 ? '👍 Хороший результат!' :
               '📚 Нужно подучить материал'}
            </div>

            <div className="space-y-3">
              <Button onClick={resetTest} className="w-full" variant="outline">
                <Icon name="RotateCcw" size={16} className="mr-2" />
                Выбрать другую тему
              </Button>
              <Button onClick={() => startTest(selectedCategory!)} className="w-full">
                <Icon name="RefreshCw" size={16} className="mr-2" />
                Пройти заново
              </Button>
            </div>
          </CardContent>
        </Card>
      </div>
    );
  }

  // Экран тестирования
  return (
    <div className="min-h-screen bg-slate-50 p-6">
      {/* Header с прогрессом */}
      <div className="max-w-4xl mx-auto mb-8">
        <div className="flex items-center justify-between mb-4">
          <Button variant="ghost" onClick={resetTest}>
            <Icon name="ArrowLeft" size={16} className="mr-2" />
            Завершить тест
          </Button>
          <div className="text-center">
            <Badge variant="secondary" className="mb-2">
              {testCategories[selectedCategory!]?.name}
            </Badge>
            <div className="text-sm text-slate-500">
              Вопрос {currentQuestion + 1} из {currentQuestions.length}
            </div>
          </div>
        </div>
        <Progress value={progress} className="h-2" />
      </div>

      {/* Основной контент */}
      <div className="max-w-4xl mx-auto">
        <Card className="exam-card">
          <CardHeader>
            <CardTitle className="text-xl leading-relaxed">
              {currentQuestions[currentQuestion]?.question}
            </CardTitle>
          </CardHeader>
          <CardContent className="space-y-4">
            {currentQuestions[currentQuestion]?.options.map((option, index) => (
              <div
                key={index}
                className={`question-option ${
                  selectedAnswer === index ? 'selected' : ''
                } ${
                  showResult && index === currentQuestions[currentQuestion].correct
                    ? 'correct'
                    : showResult && selectedAnswer === index && index !== currentQuestions[currentQuestion].correct
                    ? 'incorrect'
                    : ''
                }`}
                onClick={() => handleAnswerSelect(index)}
              >
                <div className="flex items-start gap-3">
                  <div className={`w-6 h-6 rounded-full border-2 flex items-center justify-center text-sm font-medium ${
                    selectedAnswer === index 
                      ? 'border-blue-500 bg-blue-500 text-white' 
                      : 'border-slate-300'
                  }`}>
                    {String.fromCharCode(97 + index)}
                  </div>
                  <p className="flex-1 text-slate-800 leading-relaxed">{option}</p>
                  {showResult && index === currentQuestions[currentQuestion].correct && (
                    <Icon name="Check" size={20} className="text-green-600" />
                  )}
                  {showResult && selectedAnswer === index && index !== currentQuestions[currentQuestion].correct && (
                    <Icon name="X" size={20} className="text-red-600" />
                  )}
                </div>
              </div>
            ))}

            <div className="pt-6 flex justify-between items-center">
              <div className="text-sm text-slate-500">
                {showResult ? (
                  selectedAnswer === currentQuestions[currentQuestion].correct ? (
                    <span className="text-green-600 flex items-center gap-1">
                      <Icon name="CheckCircle" size={16} />
                      Правильно!
                    </span>
                  ) : (
                    <span className="text-red-600 flex items-center gap-1">
                      <Icon name="XCircle" size={16} />
                      Неправильно
                    </span>
                  )
                ) : (
                  "Выберите один вариант ответа"
                )}
              </div>
              <Button 
                onClick={handleNextQuestion}
                disabled={selectedAnswer === null || showResult}
                className="bg-blue-600 hover:bg-blue-700"
              >
                {currentQuestion === currentQuestions.length - 1 ? 'Завершить тест' : 'Следующий вопрос'}
                <Icon name="ChevronRight" size={16} className="ml-2" />
              </Button>
            </div>
          </CardContent>
        </Card>
      </div>
    </div>
  );
};

export default Index;